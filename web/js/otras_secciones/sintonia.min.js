
var streaming="http://radiout.uttab.edu.mx:8000";var action1="fecha_hora.action";var action2="radio2.action";var action3="getProgramacionRadio.action";var dias=["D","L","M","Mi","J","V","S","D"];var mi_json="[";var now=null;var json=null;var tmp=null;var inicio=null;var fin=null;var horas_inicio=0;var minutos_inicio=0;var horas_fin=0;var minutos_fin=0;var hour_to_compare=null;var t1=null;var t2=null;$(document).ready(function(){$.ajaxSetup({cache:false});$("#sintonia_ajax").html('<img src="../img/ajax-loading.gif" alt="Ajax"/> Cargando ...');getContendView1(action2)});function getProgramacionRadio(){$("#sintonia_ajax").load("listProgramacionRadioAjax.action",{xAccion:"getProgramacionRadio"},function(){$("#radio").html("<audio preload='auto' controls style='margin-top:125px;'><source src=\""+streaming+'"/></audio>');setInterval("updateProgramacionRadio()",60000)})}function getProgramacionRadio2(){$("#sintonia_ajax").load("listProgramacionRadioAjax.action",function(){$("#radio").html("<audio preload='auto' controls style='margin-top:125px;'><source src=\""+streaming+'"/></audio>');updateProgramacionRadio2();setInterval("updateProgramacionRadio2()",60000)})}function updateProgramacionRadio(){$("#programacion_radio").html('<img src="../img/ajax-loading.gif" alt="Ajax"/> Cargando ...');$("#programacion_radio").load("listProgramacionRadioAjax.action",{xAccion:"updateProgramacionRadio"})}function updateProgramacionRadio2(){$.getJSON(action1,function(a){now=new Date(a.anio,a.mes-1,a.dia,a.hora,a.minutos,0,0);$("#programacion_radio").html("");$("#programacion_radio").html('<img src="../img/ajax-loading.gif" alt="Ajax"/> Cargando ...');$.getJSON(action3,function(b){$("#programacion_radio").html('<table class="miTabla" style="width: 100%;border-spacing:0;"><tbody></tbody></table>');$.each(b,function(c,d){$.each(d.horarios,function(f,e){$.each(e.dias,function(h,g){tmp=e.horario.split("-");inicio=tmp[0].split(":");fin=tmp[1].split(":");horas_inicio=parseInt(inicio[0]);minutos_inicio=parseInt(inicio[1]);horas_fin=parseInt(fin[0]);minutos_fin=parseInt(fin[1]);hour_to_compare=new Date(now.getFullYear(),now.getMonth(),now.getDate(),horas_fin,minutos_fin,0,0);if(g===dias[now.getDay()]){if(now.getTime()<hour_to_compare.getTime()||(hour_to_compare.getHours()===0&&hour_to_compare.getMinutes()===0&&hour_to_compare.getSeconds()===0)){mi_json+='{"nombre":"'+d.nombre+'","horario":"'+e.horario+'","horas_inicio":"'+horas_inicio+'","minutos_inicio":"'+minutos_inicio+'","horas_fin":"'+horas_fin+'","minutos_fin":"'+minutos_fin+'","dia":"'+g+'","rango_horario":false},'}}})})});mi_json+="]";mi_json=mi_json.substring(0,mi_json.lastIndexOf(","))+mi_json.substring(mi_json.lastIndexOf(",")+1,mi_json.length);json=JSON.parse(mi_json);mi_json="[";json.sort(function(d,c){t1=new Date(0,0,0,d.horas_inicio,d.minutos_inicio,0,0);t2=new Date(0,0,0,c.horas_inicio,c.minutos_inicio,0,0);return parseFloat(t1.getTime())-parseFloat(t2.getTime())});json[0].rango_horario=true;$.each(json,function(c,d){if(c+1<=3){$("div#programacion_radio table tbody").append("<tr "+(d.rango_horario?'style="background-color: #1876B2;color:#FFFFFD;"':"")+"><td>"+d.nombre+"<br/>"+d.horario+(d.rango_horario?'<img src="../img/otras_secciones/radio/btn_al_aire.png" alt="Al aire" style="float:right;"/>':"")+"</td></tr>")}else{return}})})})}function getContendView1(a){$.ajax({url:a,success:function(b){var c=$(b);$("#programacion_sintonia").remove();$("#sintonia_botones").html(c[0]);$("#sintonia_banner").html(c[2]);$("#sintonia_contenido div:first").html($(c[4]).find("div:first").prop("outerHTML"));getProgramacionRadio2()}})}function getContendView(a){$.ajax({url:a,success:function(b){var c=$(b);switch(a){case"radio2.action":$("#programacion_sintonia").remove();$("#sintonia_botones").html(c[0]);$("#sintonia_banner").html(c[2]);$("#sintonia_contenido div:first").html($(c[4]).find("div:first").prop("outerHTML"));break;case"quienes_somos.action":$("#programacion_sintonia").remove();$("#sintonia_botones").html(c[0]);$("#sintonia_banner").html(c[2]);$("#sintonia_contenido div:first").html($(c[4]).find("div:first").prop("outerHTML"));break;case"programacion.action":$("#programacion_sintonia").remove();$("#sintonia_botones").html(c[0]);$("#sintonia_banner").html(c[2]);$("#sintonia_contenido div:first").html($(c[4]).find("div:first").prop("outerHTML"));$("#sintonia_contenido").append($(c[4]).find("div:nth-child(3)").prop("outerHTML"));$("#sintonia_contenido").append($(c[4]).find("div:last").prop("outerHTML"));break;case"podcast.action":$("#programacion_sintonia").remove();$("#sintonia_botones").html(c[0]);$("#sintonia_banner").html(c[2]);$("#sintonia_contenido div:first").html($(c[4]).find("div:first").prop("outerHTML"));break}}})};